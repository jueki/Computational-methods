(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     57454,       1414]
NotebookOptionsPosition[     54769,       1324]
NotebookOutlinePosition[     55116,       1339]
CellTagsIndexPosition[     55073,       1336]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.670804999468638*^9}],

Cell[CellGroupData[{

Cell["The Sandpile Model", "Title",
 CellChangeTimes->{{3.6695747307340837`*^9, 3.669574737850984*^9}, {
  3.6706362222747707`*^9, 3.670636222728366*^9}, {3.670646261722624*^9, 
  3.670646262510315*^9}}],

Cell[TextData[StyleBox["Jonas Kaufman & Jon Ueki",
 FontSize->18]], "Text",
 CellChangeTimes->{{3.670636429915976*^9, 3.6706364353945513`*^9}, {
  3.6706366459273777`*^9, 3.670636658276753*^9}, {3.670636759792253*^9, 
  3.670636762429411*^9}}],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.670636216241534*^9, 3.670636219176571*^9}, {
  3.670636410004786*^9, 3.670636412738982*^9}}],

Cell["\<\
The Sandpile Model, also known as the Bak-Tang-Wiesenfeld model is a cellular \
automaton that aims to model systems that display critical, self-organizing \
behavior.\
\>", "Text",
 CellChangeTimes->{{3.670636267856473*^9, 3.670636274398903*^9}, {
  3.670887973046859*^9, 3.6708879746606054`*^9}, {3.670965081809882*^9, 
  3.670965180117175*^9}, {3.670965218862688*^9, 3.6709652290196238`*^9}, {
  3.670965675850211*^9, 3.6709657240547113`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics Setup", "Section",
 CellChangeTimes->{{3.670636216241534*^9, 3.670636219176571*^9}, {
  3.670636410004786*^9, 3.670636412738982*^9}, {3.670639219978614*^9, 
  3.670639221816847*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cmds", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Plot\>\"", ",", " ", "\"\<ListPlot\>\"", ",", " ", 
       "\"\<ListLinePlot\>\"", ",", " ", "\"\<ListLogPlot\>\"", ",", " ", 
       "\"\<ListLogLogPlot\>\"", ",", "\"\<LogPlot\>\"", ",", 
       "\"\<LogLogPlot\>\"", ",", "\"\<ListStepPlot\>\""}], "}"}]}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", " ", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "cmds", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{"SetOptions", "[", 
      RowBox[{
       RowBox[{"Symbol", "[", " ", 
        RowBox[{"cmds", "[", 
         RowBox[{"[", "j", "]"}], "]"}], " ", "]"}], ",", " ", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Larger", ",", " ", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Utopia\>\""}]}], "}"}]}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.669319450087964*^9, 3.669319508663763*^9}, {
  3.669385074535774*^9, 3.669385078061728*^9}, {3.670639230211617*^9, 
  3.670639234577153*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1-D Model", "Section",
 CellChangeTimes->{{3.670636216241534*^9, 3.670636219176571*^9}}],

Cell[TextData[{
 "The model takes place on a row representing half a sandpile where each cell \
has a slope ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", "n"], " "}], TraditionalForm]]],
 "and height ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["h", "n"], " ", "where", " ", 
     SubscriptBox["z", "n"]}], "=", 
    RowBox[{
     SubscriptBox["h", 
      RowBox[{"n", " "}]], "-", 
     SubscriptBox["h", 
      RowBox[{"n", "+", "1"}]]}]}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.670965249780218*^9, 3.670965350952076*^9}, {
  3.670965600355307*^9, 3.670965606409039*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"length", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zCrit1D", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.670615477425291*^9, 3.67061548511403*^9}, {
   3.670615699258256*^9, 3.670615699402074*^9}, {3.670615864854783*^9, 
   3.67061587024514*^9}, {3.6706161122962112`*^9, 3.670616112718889*^9}, {
   3.670616324323978*^9, 3.6706163489765778`*^9}, {3.670616479879706*^9, 
   3.670616481765031*^9}, {3.670635358306355*^9, 3.670635386664366*^9}, {
   3.6706355326709967`*^9, 3.670635541900044*^9}, {3.670635896925226*^9, 
   3.6706359280261173`*^9}, 3.6706359792497377`*^9, {3.670636074630343*^9, 
   3.670636105588151*^9}, {3.6706368114969883`*^9, 3.670636816287717*^9}, {
   3.670636885359851*^9, 3.6706368871018*^9}, 3.670637520057378*^9, 
   3.670637760979947*^9, {3.670637937939427*^9, 3.670637954082479*^9}, {
   3.67063834847921*^9, 3.670638352732873*^9}, {3.6706384020047398`*^9, 
   3.670638428131322*^9}, {3.67063954288664*^9, 3.670639543548015*^9}, {
   3.670644507489429*^9, 3.6706445079667*^9}, {3.6706446007744083`*^9, 
   3.670644600868038*^9}, {3.6706446529562397`*^9, 3.670644654906649*^9}, {
   3.670644781826004*^9, 3.670644822661952*^9}, {3.6706450628591747`*^9, 
   3.6706450639518642`*^9}, {3.670650348457933*^9, 3.670650367559754*^9}, {
   3.67081115243468*^9, 3.670811153697163*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"randomRow", "[", "]"}], ":=", 
  RowBox[{"row", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomInteger", "[", "zCrit", "]"}], ",", 
     RowBox[{"{", "length", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constantRow", "[", "c_", "]"}], ":=", 
  RowBox[{"row", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"c", ",", 
     RowBox[{"{", "length", "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.67064450981488*^9, 3.670644519222364*^9}}],

Cell[TextData[{
 "Adding a grain at cell ",
 StyleBox["n ",
  FontSlant->"Italic"],
 "corresponds to  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", "n"], " "}], TraditionalForm]]],
 " -> ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", "n"], " "}], TraditionalForm]]],
 "+ 1 and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", 
     RowBox[{"n", "-", "1"}]], " "}], TraditionalForm]]],
 " -> ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", 
     RowBox[{"n", "-", "1"}]], " "}], TraditionalForm]]],
 "- 1"
}], "Text",
 CellChangeTimes->{{3.670965360849131*^9, 3.6709654239422493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"addGrain", "[", "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "length"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"row", "[", 
        RowBox[{"[", "r", "]"}], "]"}], "++"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"r", ">", "1"}], ",", 
        RowBox[{
         RowBox[{"row", "[", 
          RowBox[{"[", 
           RowBox[{"r", "-", "1"}], "]"}], "]"}], "--"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670636151601828*^9, 3.670636166722478*^9}, {
  3.670636910756195*^9, 3.6706369369258757`*^9}, {3.670637062573241*^9, 
  3.6706371118645782`*^9}, {3.670637205931232*^9, 3.670637303304576*^9}, {
  3.670637377062786*^9, 3.670637422948072*^9}, {3.670637495001423*^9, 
  3.6706374951522093`*^9}, {3.670637591463532*^9, 3.670637631013378*^9}, {
  3.6706376852198*^9, 3.6706377292988663`*^9}, {3.670637771474987*^9, 
  3.670637773105582*^9}, {3.670638398517078*^9, 3.6706383986834717`*^9}, {
  3.670638475561803*^9, 3.670638476840995*^9}, {3.670638556442052*^9, 
  3.670638559479045*^9}}],

Cell[TextData[{
 "If the slope at any cell exceeds the critical slope ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "c"], TraditionalForm]]],
 ", then the cell \[OpenCurlyDoubleQuote]topples,\[CloseCurlyDoubleQuote] \
sending a grain of sand to the next cell. This corresponds to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", "n"], " "}], TraditionalForm]]],
 " -> ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", "n"], " "}], TraditionalForm]]],
 "- 2 and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", 
     RowBox[{"n", "\[PlusMinus]", "1"}]], " "}], TraditionalForm]]],
 " -> ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", 
     RowBox[{"n", "\[PlusMinus]", "1"}]], " "}], TraditionalForm]]],
 "+ 1"
}], "Text",
 CellChangeTimes->{{3.670965437679141*^9, 3.6709655375150833`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"relaxation1D", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"stable", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", "stable"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stable", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", "length"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"row", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ">", " ", "zCrit1D"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"stable", "=", "False"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"1", "<", "i", "<", "length"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-=", "2"}], ";", 
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "++"}], ";", 
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "++"}], ";"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-=", "2"}], ";", 
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "++"}], ";"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[Equal]", "length"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "--"}], ";", 
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "++"}]}]}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQ/W5W8mWVyNeO5TeYboDopEaPeyD6ywyehyBaSPzw
UxCtNyH2A4jel8OgqAqkty6VBNNCC5aZg+gvFk8swfytM91B9CufN54g+s/d
jBY9IP11/oJWEO1k/Pw3iL4kp/QPRPv8NtbWB9LPfKzA9LnwTbdANNdBttsg
uu15+AcQ/S03FUx37b3HZACk5/3wYQHRFkL+fCDag5NDFERLnJOyANGiu944
guiI2VtCQfRiIe9wEP1BdF08iJ7GFZMCojes/tEJomN0YvtBdMdaNjYjIK0z
2ZsTRFeXTZIH0UXLWRVA9Ply/3sg+vKBKWDaSeThIxBtwsv3GETnsbx9DqIT
9L6A6WMinrtMgfTjo3Vg+pCK034QHS/hB6Zf2JUcAdHb/h08CaKvt912agH5
e9dTMA0AgUjCfA==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pourSand", "[", "numGrains_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", 
      RowBox[{"rows", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "1"}], ",", 
       RowBox[{"n", "\[LessEqual]", "numGrains"}], ",", 
       RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"addGrain", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"relaxation1D", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"rows", ",", "row"}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "rows"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.670640034448517*^9, 3.670640074413542*^9}, {
   3.670640111622436*^9, 3.6706401562112627`*^9}, {3.67064019177068*^9, 
   3.670640198418159*^9}, {3.670640349920541*^9, 3.670640376551675*^9}, {
   3.670640769476622*^9, 3.6706407736522083`*^9}, {3.6706427740177193`*^9, 
   3.670642833363367*^9}, {3.670644471224394*^9, 3.67064448263144*^9}, 
   3.6706445397687817`*^9, {3.670645177590901*^9, 3.6706451779094973`*^9}, 
   3.670806604461862*^9}],

Cell["\<\
If sand is added randomly to an empty row, the pile eventually reaches a \
critical state in which the slope at each cell is simply the critical slope.\
\>", "Text",
 CellChangeTimes->{{3.670965557075638*^9, 3.6709655833936577`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"constantRow", "[", "0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rows", "=", 
   RowBox[{"pourSand", "[", "600", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"GraphicsColumn", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListStepPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"rows", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ";;"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "length"}], "}"}]}], "]"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<i\>\"", ",", "\"\<h\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"length", "*", "zCrit1D"}], "+", "1"}]}], "}"}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ListStepPlot", "[", 
       RowBox[{
        RowBox[{"rows", "[", 
         RowBox[{"[", "t", "]"}], "]"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<i\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "zCrit1D"}], "-", "1"}], ",", 
           RowBox[{"zCrit1D", "+", "1"}]}], "}"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", 
     RowBox[{"Length", "[", "rows", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
   RowBox[{"AnimationRate", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.670640165942956*^9, 3.670640189564622*^9}, {
   3.670640255235058*^9, 3.670640262792371*^9}, {3.670640404985317*^9, 
   3.670640406750502*^9}, 3.670640478178788*^9, 3.670640627759945*^9, {
   3.670640708687645*^9, 3.670640708859888*^9}, 3.670641427883388*^9, {
   3.6706417358882847`*^9, 3.6706419727910643`*^9}, {3.670642040779307*^9, 
   3.670642049755105*^9}, {3.6706422289413643`*^9, 3.670642318887772*^9}, {
   3.670642408726111*^9, 3.670642476543838*^9}, {3.670642514588134*^9, 
   3.670642567386112*^9}, {3.6706426241434402`*^9, 3.67064266666263*^9}, {
   3.670642812933423*^9, 3.670642864290378*^9}, {3.670644553127784*^9, 
   3.670644577149531*^9}, {3.670644664973056*^9, 3.670644700033276*^9}, {
   3.6706447338919363`*^9, 3.6706447495605097`*^9}, {3.670644807427887*^9, 
   3.670644876431072*^9}, {3.670644911391144*^9, 3.670644917981215*^9}, {
   3.670644960418167*^9, 3.670645066387751*^9}, {3.670645118038232*^9, 
   3.6706451312497797`*^9}, {3.670645187015779*^9, 3.670645192469298*^9}, {
   3.670645226085885*^9, 3.67064527122759*^9}, {3.670645305187829*^9, 
   3.670645356220088*^9}, {3.670646834693962*^9, 3.670646850345436*^9}, {
   3.670647076099144*^9, 3.67064709747235*^9}, 3.670647305308791*^9, {
   3.670650381118085*^9, 3.670650381262953*^9}, {3.6708072597175426`*^9, 
   3.67080726071541*^9}, {3.670811173945546*^9, 3.6708111786032963`*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[
   FormBox[
    StyleBox[
     DynamicModuleBox[{$CellContext`t$$ = 1, Typeset`show$$ = True, 
      Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
      Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
      "\"untitled\"", Typeset`specs$$ = {{
        Hold[$CellContext`t$$], 1, 600, 1}}, Typeset`size$$ = {
      227., {213., 219.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
      Typeset`skipInitDone$$ = True, $CellContext`t$226507$$ = 0}, 
      DynamicBox[Manipulate`ManipulateBoxes[
       1, TraditionalForm, "Variables" :> {$CellContext`t$$ = 1}, 
        "ControllerVariables" :> {
          Hold[$CellContext`t$$, $CellContext`t$226507$$, 0]}, 
        "OtherVariables" :> {
         Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
          Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
          Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
          Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> 
        GraphicsColumn[{
           ListStepPlot[
            Table[
             Total[
              Part[
               Part[$CellContext`rows, $CellContext`t$$], 
               
               Span[$CellContext`i, 
                All]]], {$CellContext`i, $CellContext`length}], 
            FrameLabel -> {"i", "h"}, 
            PlotRange -> {0, $CellContext`length $CellContext`zCrit1D + 1}], 
           ListStepPlot[
            Part[$CellContext`rows, $CellContext`t$$], 
            FrameLabel -> {"i", "z"}, 
            PlotRange -> {-$CellContext`zCrit1D - 1, $CellContext`zCrit1D + 
              1}]}], "Specifications" :> {{$CellContext`t$$, 1, 600, 1, 
           Appearance -> "Labeled", AnimationRunning -> False, AnimationRate -> 
           Automatic, 
           AppearanceElements -> {
            "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
             "DirectionButton"}}}, 
        "Options" :> {
         ControlType -> Animator, AppearanceElements -> None, 
          DefaultBaseStyle -> "Animate", DefaultLabelStyle -> "AnimateLabel", 
          SynchronousUpdating -> True, ShrinkingDelay -> 10.}, 
        "DefaultOptions" :> {}],
       ImageSizeCache->{393., {251., 258.}},
       SingleEvaluation->True],
      Deinitialization:>None,
      DynamicModuleValues:>{},
      SynchronousInitialization->True,
      UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
      UnsavedVariables:>{Typeset`initDone$$},
      UntrackedVariables:>{Typeset`size$$}], "Animate",
     Deployed->True,
     StripOnInput->False],
    TraditionalForm],
   Manipulate`InterpretManipulate[1]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.67064254524675*^9, 3.670642568215046*^9}, 
   3.6706426674734373`*^9, 3.670642809926433*^9, {3.670642841008926*^9, 
   3.670642864731658*^9}, {3.670642917775036*^9, 3.670642955691597*^9}, {
   3.670644549754939*^9, 3.6706446658263397`*^9}, 3.670644701429081*^9, {
   3.6706447349961367`*^9, 3.670644751399021*^9}, {3.670644786263734*^9, 
   3.6706448770042267`*^9}, {3.670644957185383*^9, 3.67064498961308*^9}, {
   3.670645027801117*^9, 3.670645084725136*^9}, {3.670645122628437*^9, 
   3.670645132252879*^9}, 3.670645198371286*^9, {3.670645249677415*^9, 
   3.67064535793937*^9}, 3.670645461122727*^9, {3.670646823040165*^9, 
   3.6706468521312447`*^9}, {3.670647078136504*^9, 3.670647085658746*^9}, {
   3.670647306684074*^9, 3.6706473197316236`*^9}, {3.670650329632782*^9, 
   3.670650382970113*^9}, 3.670650455293717*^9, 3.670806607392416*^9, {
   3.670807247188053*^9, 3.6708072615641108`*^9}, 3.670808530700899*^9, {
   3.6708111263526497`*^9, 3.670811180997473*^9}, 3.670812996814458*^9, 
   3.6709643803931704`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2-D Model", "Section",
 CellChangeTimes->{{3.670636216241534*^9, 3.670636241807906*^9}}],

Cell[TextData[{
 "In two dimensions, the model takes place on a grid representing a quarter \
of a sandpile where each cell has a slope ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", 
     RowBox[{"i", ",", "j"}]], " ", "."}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.67096561698726*^9, 3.670965643052623*^9}, {
  3.670965736408785*^9, 3.67096575895406*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Initialization", "Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.6700035946241255`*^9, 3.670003604199503*^9}, 
   3.670208651815277*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gridSize", " ", "=", " ", "10"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "how", " ", "many", " ", "rows", " ", "and", " ", "columns", " ", "in", 
    " ", "a", " ", "grid"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zCrit", " ", "=", " ", "3"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "max", " ", "slope", " ", "possible"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grid", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "gridSize"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "gridSize"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"the", " ", "sandpile"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"avalancheFreq", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", 
        RowBox[{"2", " ", "*", " ", 
         SuperscriptBox["gridSize", "2"]}]}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "how", " ", "many", " ", "times", " ", "an", " ", "avalanche", " ", "of", 
    " ", "a", " ", "certain", " ", "size", " ", "occurs"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"avalancheTime", " ", "=", " ", 
    RowBox[{"{", "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "size", " ", "of", " ", "an", " ", "avalanche", " ", "when", 
    " ", "the", " ", "nth", " ", "grain", " ", "of", " ", "sand", " ", "is", 
    " ", "dropped"}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6700035674723597`*^9, 3.6700036542782106`*^9}, {
   3.670003729539316*^9, 3.6700037396323767`*^9}, {3.670207058776082*^9, 
   3.6702070654095435`*^9}, {3.6702073107343826`*^9, 3.670207316806773*^9}, {
   3.670208390367284*^9, 3.670208394278058*^9}, {3.6702089985026712`*^9, 
   3.670209004866353*^9}, {3.6702859740925617`*^9, 3.6702859886186266`*^9}, 
   3.670287023278055*^9, 3.6702871403086767`*^9, {3.6702877382812357`*^9, 
   3.670287740899297*^9}, {3.670288056467272*^9, 3.67028807183197*^9}, {
   3.670289408833767*^9, 3.670289413297996*^9}, {3.670530994361991*^9, 
   3.6705310018046536`*^9}, {3.670531058545551*^9, 3.6705310678622437`*^9}, {
   3.6705311498230276`*^9, 3.670531150029791*^9}, {3.670531234651291*^9, 
   3.67053123818919*^9}, {3.6706478198241377`*^9, 3.6706478393187304`*^9}, {
   3.670649879546425*^9, 3.670649913282119*^9}, {3.6706502362129*^9, 
   3.6706502376998663`*^9}, {3.670651331502338*^9, 3.6706513316056433`*^9}, 
   3.670652058550596*^9, {3.6706892494756384`*^9, 3.6706892664886208`*^9}, {
   3.6706893117052517`*^9, 3.670689339172864*^9}, {3.670810632176502*^9, 
   3.670810632423764*^9}, {3.670810839349917*^9, 3.6708108422110043`*^9}, {
   3.670811055031866*^9, 3.67081108701227*^9}, {3.670811962940998*^9, 
   3.6708119630520144`*^9}, {3.670812633292508*^9, 3.670812633394947*^9}, {
   3.670814090465981*^9, 3.670814090608498*^9}, {3.670814269181888*^9, 
   3.6708142694111977`*^9}, {3.6708148579372883`*^9, 
   3.6708148585807333`*^9}, {3.6708149682771378`*^9, 
   3.6708149694593277`*^9}, {3.670816550702965*^9, 3.670816562164089*^9}, {
   3.6708877445629754`*^9, 3.6708877751032696`*^9}, {3.670964124676005*^9, 
   3.670964125154002*^9}, {3.671236306010707*^9, 3.671236448810544*^9}, {
   3.6712364850210485`*^9, 3.671236485406262*^9}, {3.671236520758576*^9, 
   3.6712365264968176`*^9}, 3.671236563524435*^9, {3.671237075381336*^9, 
   3.6712370759134994`*^9}, {3.671237142471999*^9, 3.6712371425566993`*^9}, {
   3.67123745134059*^9, 3.671237453791215*^9}, {3.671237817722788*^9, 
   3.671237859845804*^9}, {3.6712383200808992`*^9, 3.671238359290085*^9}, {
   3.6712384039483585`*^9, 3.671238424259959*^9}, {3.6712386560732718`*^9, 
   3.6712386832529144`*^9}, {3.671240688595587*^9, 3.671240688949425*^9}, {
   3.6712415552752976`*^9, 3.671241677714609*^9}, {3.6712420197875633`*^9, 
   3.671242020872123*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Updating Code", "Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.670887790940078*^9, 3.670887806017845*^9}}],

Cell["\<\
We are using nonconservative perturbations in which a grain is added by \
simply increasing the slope at a cell by one.\
\>", "Text",
 CellChangeTimes->{{3.6709657699903316`*^9, 3.670965798684525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"addSand", "[", 
    RowBox[{"random_", ",", "place_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "j"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"random", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", " ", "we", " ", "activate", " ", "random"}], ",", " ", 
          RowBox[{"then", " ", "add", " ", "grains", " ", "randomly"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "gridSize"}], "}"}], "]"}]}], ";", 
         RowBox[{"j", "=", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "gridSize"}], "}"}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"place", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"j", "=", 
          RowBox[{"place", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", "2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "--"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "--"}]}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"update", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670651937473474*^9, 3.670652056859351*^9}, 
   3.670810630004347*^9, {3.670811055041031*^9, 3.670811073580756*^9}, {
   3.670811330361491*^9, 3.670811367446313*^9}, {3.670811525648734*^9, 
   3.670811541370268*^9}, {3.6708117614916143`*^9, 3.670811808963633*^9}, {
   3.670811986757161*^9, 3.6708119869400883`*^9}, 3.670812047694068*^9, {
   3.670812215809943*^9, 3.67081222038442*^9}, {3.6708123013195066`*^9, 
   3.670812301926342*^9}, {3.670964678187196*^9, 3.670964681041251*^9}}],

Cell["\<\
In 2D, a toppled cell loses 4 from its slope and sends 1 slope to each of its \
compass neighbors. \
\>", "Text",
 CellChangeTimes->{{3.67096580714957*^9, 3.670965833579558*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"update", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "updates", " ", "the", " ", "cell", " ", "according", " ", "to", " ", 
      "these", " ", "set", " ", "of", " ", "rules"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"grid", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ">", "zCrit"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "++"}], ";", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "-=", "4"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"add", " ", "sand", " ", "to", " ", "neighbors"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "++"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[NotEqual]", "1"}], ",", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "++"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[NotEqual]", "gridSize"}], ",", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}], "++"}]}], 
         "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[NotEqual]", "gridSize"}], ",", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "++"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"relax", " ", "neighbors"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[NotEqual]", "1"}], ",", 
          RowBox[{"update", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "j"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[NotEqual]", "1"}], ",", 
          RowBox[{"update", "[", 
           RowBox[{"i", ",", 
            RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[NotEqual]", "gridSize"}], ",", 
          RowBox[{"update", "[", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", "j"}], "]"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[NotEqual]", "gridSize"}], ",", 
          RowBox[{"update", "[", 
           RowBox[{"i", ",", 
            RowBox[{"j", "+", "1"}]}], "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670810898539713*^9, 3.6708109432487307`*^9}, {
   3.670811055057275*^9, 3.6708110735915537`*^9}, {3.670811433156896*^9, 
   3.670811442589637*^9}, 3.67081158605191*^9, {3.6708122280416183`*^9, 
   3.670812298173991*^9}, 3.670812360878578*^9, {3.670812401015964*^9, 
   3.670812406317479*^9}, {3.6708125366446047`*^9, 3.670812536964044*^9}, {
   3.6708135904227457`*^9, 3.6708136018522043`*^9}, {3.671241757996481*^9, 
   3.67124177039764*^9}}],

Cell["\<\
This funcion drops totalSand_ many grains of sand and updates the sandpile\
\>", "Text",
 CellChangeTimes->{{3.671241776341959*^9, 3.67124179977769*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"run", "[", 
   RowBox[{"totalSand_", ",", " ", 
    RowBox[{"random_:", "False"}], ",", 
    RowBox[{"place_:", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "T", ",", 
      RowBox[{"sList", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"TList", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "1"}], ",", 
       RowBox[{"n", "\[LessEqual]", " ", "totalSand"}], ",", 
       RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"addSand", "[", 
         RowBox[{"random", ",", "place"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"sList", ",", "s"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"avalancheTime", ",", " ", "s"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"avalancheFreq", "[", 
          RowBox[{"[", 
           RowBox[{"s", "+", "1"}], "]"}], "]"}], "++"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "sList"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6712378750075955`*^9, 3.6712379216680565`*^9}, 
   3.671238238014965*^9, {3.6712382864464006`*^9, 3.6712382897952027`*^9}, {
   3.6712384406717873`*^9, 3.67123844105672*^9}, {3.6712385777230186`*^9, 
   3.67123863856653*^9}, {3.671240580339079*^9, 3.671240580869954*^9}, {
   3.6712406119451747`*^9, 3.671240633021205*^9}, {3.6712407542763805`*^9, 
   3.671240763080536*^9}, {3.6712408031840973`*^9, 3.67124080508645*^9}, {
   3.671241264477045*^9, 3.671241316317814*^9}, {3.6712420122615423`*^9, 
   3.6712420131260056`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialize the Grid with random slopes or constant slopes", \
"Subsubsection",
 CellChangeTimes->{{3.670287147812068*^9, 3.670287153700289*^9}, 
   3.67088785133657*^9, {3.6712418215279922`*^9, 3.6712418314425898`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"randomGrid", "[", "]"}], ":=", 
   RowBox[{"grid", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomInteger", "[", "zCrit", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "gridSize"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "gridSize"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670650665554462*^9, 3.6706506660102797`*^9}, {
   3.6706513855571537`*^9, 3.6706513857634*^9}, {3.670805711605267*^9, 
   3.670805711787799*^9}, {3.6708058878097277`*^9, 3.6708058880708637`*^9}, {
   3.6708060061874437`*^9, 3.6708060108111153`*^9}, {3.670811055074538*^9, 
   3.670811073601594*^9}, {3.670813951583077*^9, 3.6708139525640497`*^9}, 
   3.670814280213694*^9, {3.670815986580615*^9, 3.670816019169142*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"constantGrid", "[", "c_", "]"}], ":=", 
   RowBox[{"grid", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"c", ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "gridSize"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "gridSize"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6708160328900023`*^9, 3.670816042154893*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualization Functions", "Subsubsection",
 CellChangeTimes->{{3.670690096808093*^9, 3.6706901005126104`*^9}, {
  3.671241851772714*^9, 3.671241855052204*^9}}],

Cell["Distribution of slopes", "Text",
 CellChangeTimes->{{3.670690103559189*^9, 3.6706901107914147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"slopeDist", "[", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"slopes", ",", " ", 
       RowBox[{"slopedist", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", " ", "i", ",", " ", "j"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"slopes", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", ",", " ", "0", ",", " ", "zCrit"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", "gridSize"}], ",", " ", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", " ", 
           RowBox[{"j", "\[LessEqual]", "gridSize"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"slopes", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"grid", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "+", " ", "1"}],
                "]"}], "]"}], "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"make", " ", "x"}], "-", 
        RowBox[{"coordinate", " ", "and", " ", "y"}], "-", 
        RowBox[{"coordinate", " ", "pair"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "slopes", "]"}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"slopedist", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", " ", 
             RowBox[{"slopes", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "slopedist"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.670690120565658*^9, 3.6706901330739737`*^9}, {
   3.670690168715764*^9, 3.670690281016213*^9}, {3.670690415614914*^9, 
   3.6706905065571475`*^9}, {3.670811055099996*^9, 3.670811073557596*^9}, {
   3.6708878343259335`*^9, 3.670887834582147*^9}, 3.6708878813312073`*^9}],

Cell["Visualize the height of the sandpile", "Text",
 CellChangeTimes->{{3.670887889060586*^9, 3.670887893343771*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"heights", "[", "grid_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", 
      RowBox[{"heights", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", " ", 
             RowBox[{"2", "*", "gridSize"}]}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", ",", " ", 
           RowBox[{"2", "*", "gridSize"}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"gridSize", "-", "1"}]}], ",", 
       RowBox[{"i", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"gridSize", "-", "1"}]}], ",", 
          RowBox[{"j", "\[GreaterEqual]", "0"}], ",", 
          RowBox[{"j", "--"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"heights", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", " ", "+", " ", "gridSize"}], ",", 
               RowBox[{"j", " ", "+", " ", "gridSize"}]}], "]"}], "]"}], "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"i", "\[Equal]", "0"}], " ", "||", " ", 
               RowBox[{"j", "\[Equal]", "0"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"0.5", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"grid", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}], " ", "+", " ", 
                 RowBox[{"heights", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1", " ", "+", " ", "gridSize"}], ",", 
                    RowBox[{"j", " ", "+", " ", "gridSize"}]}], "]"}], "]"}], 
                 "+", 
                 RowBox[{"heights", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", " ", "+", " ", "gridSize"}], ",", 
                    RowBox[{"j", "+", "1", " ", "+", " ", "gridSize"}]}], 
                   "]"}], "]"}]}], ")"}]}], ",", 
              RowBox[{"0.5", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"grid", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
                 RowBox[{"heights", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1", " ", "+", " ", "gridSize"}], ",", 
                    RowBox[{"j", " ", "+", " ", "gridSize"}]}], "]"}], "]"}], 
                 "+", 
                 RowBox[{"heights", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", " ", "+", " ", "gridSize"}], ",", 
                    RowBox[{"j", "+", "1", " ", "+", " ", "gridSize"}]}], 
                   "]"}], "]"}]}], ")"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"heights", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"gridSize", "-", "i"}], ",", " ", 
               RowBox[{"gridSize", "+", "j"}]}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"heights", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", " ", "+", " ", "gridSize"}], ",", 
               RowBox[{"j", " ", "+", " ", "gridSize"}]}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"heights", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"gridSize", "+", "i"}], ",", " ", 
               RowBox[{"gridSize", " ", "-", " ", "j"}]}], "]"}], "]"}], " ", 
            "=", " ", 
            RowBox[{"heights", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", " ", "+", " ", "gridSize"}], ",", 
               RowBox[{"j", " ", "+", " ", "gridSize"}]}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"heights", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"gridSize", "-", "i"}], ",", " ", 
               RowBox[{"gridSize", " ", "-", " ", "j"}]}], "]"}], "]"}], " ", 
            "=", " ", 
            RowBox[{"heights", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", " ", "+", " ", "gridSize"}], ",", 
               RowBox[{"j", " ", "+", " ", "gridSize"}]}], "]"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "heights"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6708881604782376`*^9, 3.6708881896243067`*^9}, {
  3.6708882627003045`*^9, 3.6708882807705812`*^9}, {3.670888316887884*^9, 
  3.6708883832963767`*^9}, {3.6708884463930206`*^9, 3.6708884687510023`*^9}, {
  3.6709398315525184`*^9, 3.6709399240864687`*^9}, {3.670940015586836*^9, 
  3.6709400219190364`*^9}, {3.6709402104622216`*^9, 3.6709402804844217`*^9}, {
  3.670940339933061*^9, 3.670940405171117*^9}, {3.67094044508788*^9, 
  3.670940445334346*^9}, {3.6712362970904355`*^9, 3.671236297822009*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run and Plot the Simulation", "Subsubsection",
 CellChangeTimes->{{3.67028830224984*^9, 3.6702883061856146`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"constantGrid", "[", "0", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6708059902360983`*^9, 3.670805991940957*^9}, {
   3.670806029348736*^9, 3.6708060329078836`*^9}, {3.670816053778927*^9, 
   3.6708160619438457`*^9}, {3.6708160954494047`*^9, 
   3.6708160958730173`*^9}, {3.670816447384444*^9, 3.670816447544026*^9}, 
   3.6708166388153753`*^9, {3.6708166859621143`*^9, 3.6708166899526854`*^9}, {
   3.6709641714258757`*^9, 3.6709641731605043`*^9}, {3.6709642073598127`*^9, 
   3.6709642075194883`*^9}, {3.670964262944077*^9, 3.670964264778667*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"run", "[", 
   RowBox[{"1000", ",", "True"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6702859322849283`*^9, 3.6702859614343853`*^9}, {
   3.6702860221837025`*^9, 3.6702860236159105`*^9}, 3.670286138131914*^9, 
   3.670286809097667*^9, {3.6702868412977843`*^9, 3.6702868423997726`*^9}, 
   3.6702871056671853`*^9, 3.670287202177389*^9, 3.670289436784025*^9, {
   3.6702895420402536`*^9, 3.670289555098251*^9}, {3.670531172805149*^9, 
   3.6705311913801556`*^9}, {3.670649795303378*^9, 3.6706498968813353`*^9}, {
   3.670649947914124*^9, 3.670649948993037*^9}, {3.670650191702284*^9, 
   3.670650241395158*^9}, {3.670650583668469*^9, 3.670650605625211*^9}, {
   3.67065130978328*^9, 3.6706513224053383`*^9}, {3.67065151726453*^9, 
   3.67065152544779*^9}, {3.670651812705233*^9, 3.670651860417141*^9}, {
   3.670689076704313*^9, 3.6706890769516*^9}, {3.6706893755659475`*^9, 
   3.670689410709156*^9}, {3.6706895740500154`*^9, 3.670689603231742*^9}, {
   3.6706896511583023`*^9, 3.6706896741461716`*^9}, {3.6706897378525543`*^9, 
   3.670689751731151*^9}, {3.6706905843885856`*^9, 3.6706905853791256`*^9}, 
   3.670805894016836*^9, {3.670805958166151*^9, 3.670805985926292*^9}, {
   3.6708060950193243`*^9, 3.67080609533698*^9}, 3.670806250902162*^9, {
   3.67080667164476*^9, 3.670806672082673*^9}, {3.6708067861522007`*^9, 
   3.670806786454555*^9}, {3.670806947555683*^9, 3.670806950914152*^9}, 
   3.670806992136415*^9, 3.67080877903728*^9, {3.670810672785581*^9, 
   3.670810673111813*^9}, 3.670810715294689*^9, {3.670811454746943*^9, 
   3.670811482633988*^9}, {3.670811633259078*^9, 3.670811651792667*^9}, 
   3.67081168716885*^9, {3.670811736653734*^9, 3.6708117377869797`*^9}, {
   3.6708119780372343`*^9, 3.670811978500205*^9}, {3.670812313598871*^9, 
   3.6708123179729853`*^9}, {3.670812411383593*^9, 3.670812421125062*^9}, {
   3.67081252552486*^9, 3.670812528101048*^9}, {3.670812575123398*^9, 
   3.6708125759701138`*^9}, {3.67081263777943*^9, 3.670812638011129*^9}, {
   3.6708136104370537`*^9, 3.670813630011838*^9}, {3.670813868420188*^9, 
   3.67081390438969*^9}, {3.670814028027649*^9, 3.6708140287940598`*^9}, {
   3.670814067778496*^9, 3.670814068401246*^9}, {3.6708141296248407`*^9, 
   3.670814132384794*^9}, {3.670814288748166*^9, 3.6708143011228523`*^9}, {
   3.6708146221138887`*^9, 3.670814647607892*^9}, {3.67081473620975*^9, 
   3.670814751521532*^9}, {3.670814789960264*^9, 3.670814790150961*^9}, {
   3.6708148642952423`*^9, 3.670814895716277*^9}, {3.670815934637918*^9, 
   3.670815935483241*^9}, {3.670816103353299*^9, 3.6708161180485973`*^9}, {
   3.670816397758429*^9, 3.670816407398776*^9}, 3.670816460840042*^9, {
   3.670816627479204*^9, 3.6708166298266068`*^9}, 3.670816688192832*^9, 
   3.6708879517090592`*^9, 3.670888012435957*^9, {3.670964101276537*^9, 
   3.6709641042356443`*^9}, {3.670964136025247*^9, 3.670964140777535*^9}, {
   3.670964266922742*^9, 3.670964281713172*^9}, 3.6712380171176777`*^9, 
   3.6712380880165153`*^9, 3.671238245018445*^9, {3.6712406419995403`*^9, 
   3.6712406441950064`*^9}, {3.671240776689477*^9, 3.6712407768996463`*^9}, {
   3.6712422211253896`*^9, 3.671242222969776*^9}, 3.671242467447804*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"grid", ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6702869552154093`*^9, 3.6702869604373145`*^9}, {
   3.6702870040789757`*^9, 3.6702870116285143`*^9}, {3.67028717519384*^9, 
   3.6702871763940783`*^9}, {3.6702872638648043`*^9, 3.6702872671292067`*^9}, 
   3.670287311325121*^9, {3.6702885120817785`*^9, 3.6702885317573233`*^9}, {
   3.6702893925070853`*^9, 3.670289394048932*^9}, {3.6702895082756205`*^9, 
   3.6702895115984626`*^9}, {3.670646565346911*^9, 3.670646565585709*^9}, {
   3.670646616555067*^9, 3.670646634312932*^9}, {3.6708059540151587`*^9, 
   3.670805954872246*^9}, {3.670806237583953*^9, 3.670806239852871*^9}, {
   3.670808749198401*^9, 3.670808750964007*^9}, {3.670813769455782*^9, 
   3.6708137707497253`*^9}, {3.6708138875834713`*^9, 3.670813889158877*^9}, {
   3.670814000780551*^9, 3.670814008650384*^9}, {3.670816464186811*^9, 
   3.670816464900135*^9}, {3.670816650527594*^9, 3.6708166748057337`*^9}, {
   3.670887902353586*^9, 3.6708879034634495`*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ArrayPlot[$CellContext`grid, PlotLegends -> Automatic], StandardForm],
  ImageSizeCache->{310., {2., 8.}}]], "Output",
 CellChangeTimes->{{3.670813891380769*^9, 3.670813966099946*^9}, 
   3.6708140090155277`*^9, 3.670814110048999*^9, {3.670814316975876*^9, 
   3.670814320212762*^9}, 3.670814788069556*^9, 3.6708149395043707`*^9, 
   3.670814981939918*^9, {3.670816076961795*^9, 3.670816101733259*^9}, {
   3.6708161539343224`*^9, 3.670816162027424*^9}, {3.670816383436458*^9, 
   3.670816391552389*^9}, 3.670816465490728*^9, 3.670816578242178*^9, {
   3.670816675377585*^9, 3.670816707037204*^9}, {3.670887903915629*^9, 
   3.67088791559101*^9}, 3.670939956247138*^9, 3.6709640757630577`*^9, 
   3.6709642151086283`*^9, 3.671238014715658*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"heights", "[", "grid", "]"}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", " ", 
   RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "0", ",", " ", "1"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.670806733631798*^9, 3.670806735967567*^9}, {
   3.670808753830513*^9, 3.670808767083536*^9}, {3.670808843787479*^9, 
   3.670808845377989*^9}, {3.670810734415647*^9, 3.670810749340456*^9}, {
   3.67081477105897*^9, 3.670814771154784*^9}, {3.670814848375066*^9, 
   3.670814848709165*^9}, {3.67081500705084*^9, 3.670815045818143*^9}, {
   3.670815081009226*^9, 3.6708151099782248`*^9}, {3.67081514583191*^9, 
   3.670815222900394*^9}, {3.670815257667506*^9, 3.6708155693135242`*^9}, {
   3.6708156237869377`*^9, 3.6708156620549707`*^9}, {3.6708157140440607`*^9, 
   3.6708157144024754`*^9}, {3.6708158442977457`*^9, 3.670815874968793*^9}, {
   3.6708161327525682`*^9, 3.6708161335216913`*^9}, 3.6709399720222855`*^9, 
   3.6712363006712255`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"avalancheTime", ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{
            RowBox[{"Length", "[", "avalancheTime", "]"}], "-", "100"}]}], 
          "]"}], ",", " ", 
         RowBox[{"Length", "[", "avalancheTime", "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "40"}], "}"}]}], "}"}]}], ",", " ", 
    RowBox[{"Filling", " ", "\[Rule]", " ", "Axis"}], ",", 
    RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"timestep", ",", " ", "s"}], "}"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6712380392226887`*^9, 3.671238061323532*^9}, {
   3.671238102732131*^9, 3.6712381040631638`*^9}, {3.671238166679922*^9, 
   3.671238167412407*^9}, {3.671238450209159*^9, 3.6712384509622307`*^9}, {
   3.671238489273144*^9, 3.671238489657842*^9}, {3.671238699396926*^9, 
   3.6712387035443764`*^9}, 3.6712418837248015`*^9, {3.671242360119426*^9, 
   3.6712424598798776`*^9}, {3.671242556179883*^9, 3.671242559402855*^9}, 
   3.6712426585734496`*^9}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ListPlot[$CellContext`avalancheTime, PlotRange -> {{
       Max[0, Length[$CellContext`avalancheTime] - 100], 
       Length[$CellContext`avalancheTime]}, {0, 40}}, Filling -> Axis, Axes -> 
    False, AxesLabel -> {$CellContext`t, $CellContext`s}], StandardForm],
  ImageSizeCache->{780., {2., 8.}}]], "Output",
 CellChangeTimes->{{3.671242385562888*^9, 3.6712424616572905`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ListLogPlot", "[", "avalancheFreq", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6712413208171377`*^9, 3.671241323405026*^9}, {
  3.6712420287279873`*^9, 3.6712420406497374`*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ListLogPlot[$CellContext`avalancheFreq], StandardForm],
  ImageSizeCache->{208., {2., 8.}}]], "Output",
 CellChangeTimes->{
  3.6712413238192687`*^9, 3.671241448476513*^9, {3.671242031441595*^9, 
   3.6712420413054*^9}, {3.671242101949075*^9, 3.6712421228362713`*^9}}]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{{3.671242172023719*^9, 3.671242204027006*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 70, 1, 52, "Input"],
Cell[CellGroupData[{
Cell[653, 25, 203, 3, 101, "Title"],
Cell[859, 30, 243, 4, 35, "Text"],
Cell[CellGroupData[{
Cell[1127, 38, 146, 2, 70, "Section"],
Cell[1276, 42, 456, 8, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1769, 55, 197, 3, 70, "Section"],
Cell[1969, 60, 1305, 32, 72, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3311, 97, 94, 1, 70, "Section"],
Cell[3408, 100, 638, 22, 32, "Text"],
Cell[4049, 124, 1370, 21, 52, "Input"],
Cell[5422, 147, 513, 14, 52, "Input"],
Cell[5938, 163, 646, 28, 30, "Text"],
Cell[6587, 193, 1371, 32, 112, "Input"],
Cell[7961, 227, 850, 30, 30, "Text"],
Cell[8814, 259, 3288, 79, 272, "Input"],
Cell[12105, 340, 1298, 28, 172, "Input"],
Cell[13406, 370, 243, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[13674, 378, 3345, 70, 132, "Input"],
Cell[17022, 450, 3735, 73, 526, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20806, 529, 94, 1, 70, "Section"],
Cell[20903, 532, 386, 10, 33, "Text"],
Cell[CellGroupData[{
Cell[21314, 546, 167, 2, 41, "Subsubsection"],
Cell[21484, 550, 4114, 82, 135, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25635, 637, 138, 1, 41, "Subsubsection"],
Cell[25776, 640, 211, 4, 30, "Text"],
Cell[25990, 646, 2736, 69, 212, "Input"],
Cell[28729, 717, 188, 4, 30, "Text"],
Cell[28920, 723, 3860, 103, 272, "Input"],
Cell[32783, 828, 163, 3, 30, "Text"],
Cell[32949, 833, 1942, 44, 212, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34928, 882, 225, 3, 39, "Subsubsection"],
Cell[35156, 887, 905, 20, 31, "Input"],
Cell[36064, 909, 489, 14, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36590, 928, 165, 2, 39, "Subsubsection"],
Cell[36758, 932, 106, 1, 30, "Text"],
Cell[36867, 935, 2681, 65, 292, "Input"],
Cell[39551, 1002, 118, 1, 30, "Text"],
Cell[39672, 1005, 5608, 131, 292, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45317, 1141, 119, 1, 39, "Subsubsection"],
Cell[45439, 1144, 587, 9, 31, "Input"],
Cell[46029, 1155, 3211, 45, 31, "Input"],
Cell[CellGroupData[{
Cell[49265, 1204, 1123, 17, 31, "Input"],
Cell[50391, 1223, 781, 12, 31, "Output"]
}, Open  ]],
Cell[51187, 1238, 1169, 20, 31, "Input"],
Cell[CellGroupData[{
Cell[52381, 1262, 1242, 27, 52, "Input"],
Cell[53626, 1291, 418, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54081, 1303, 231, 4, 31, "Input"],
Cell[54315, 1309, 306, 6, 31, "Output"]
}, Open  ]],
Cell[54636, 1318, 93, 1, 31, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

