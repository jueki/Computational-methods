(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47515,       1179]
NotebookOptionsPosition[     45098,       1096]
NotebookOutlinePosition[     45452,       1112]
CellTagsIndexPosition[     45409,       1109]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\n"], "Input",
 CellChangeTimes->{3.670804999468638*^9}],

Cell[CellGroupData[{

Cell["The Sandpile Model", "Title",
 CellChangeTimes->{{3.6695747307340837`*^9, 3.669574737850984*^9}, {
  3.6706362222747707`*^9, 3.670636222728366*^9}, {3.670646261722624*^9, 
  3.670646262510315*^9}}],

Cell[TextData[StyleBox["Jonas Kaufman & Jon Ueki",
 FontSize->18]], "Text",
 CellChangeTimes->{{3.670636429915976*^9, 3.6706364353945513`*^9}, {
  3.6706366459273777`*^9, 3.670636658276753*^9}, {3.670636759792253*^9, 
  3.670636762429411*^9}}],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.670636216241534*^9, 3.670636219176571*^9}, {
  3.670636410004786*^9, 3.670636412738982*^9}}],

Cell["(intro goes here)", "Text",
 CellChangeTimes->{{3.670636267856473*^9, 3.670636274398903*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics Setup", "Section",
 CellChangeTimes->{{3.670636216241534*^9, 3.670636219176571*^9}, {
  3.670636410004786*^9, 3.670636412738982*^9}, {3.670639219978614*^9, 
  3.670639221816847*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cmds", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Plot\>\"", ",", " ", "\"\<ListPlot\>\"", ",", " ", 
       "\"\<ListLinePlot\>\"", ",", " ", "\"\<ListLogPlot\>\"", ",", " ", 
       "\"\<ListLogLogPlot\>\"", ",", "\"\<LogPlot\>\"", ",", 
       "\"\<LogLogPlot\>\"", ",", "\"\<ListStepPlot\>\""}], "}"}]}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", " ", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "cmds", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{"SetOptions", "[", 
      RowBox[{
       RowBox[{"Symbol", "[", " ", 
        RowBox[{"cmds", "[", 
         RowBox[{"[", "j", "]"}], "]"}], " ", "]"}], ",", " ", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Larger", ",", " ", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Utopia\>\""}]}], "}"}]}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.669319450087964*^9, 3.669319508663763*^9}, {
  3.669385074535774*^9, 3.669385078061728*^9}, {3.670639230211617*^9, 
  3.670639234577153*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1-D Model", "Section",
 CellChangeTimes->{{3.670636216241534*^9, 3.670636219176571*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"length", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zCrit", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.670615477425291*^9, 3.67061548511403*^9}, {
   3.670615699258256*^9, 3.670615699402074*^9}, {3.670615864854783*^9, 
   3.67061587024514*^9}, {3.6706161122962112`*^9, 3.670616112718889*^9}, {
   3.670616324323978*^9, 3.6706163489765778`*^9}, {3.670616479879706*^9, 
   3.670616481765031*^9}, {3.670635358306355*^9, 3.670635386664366*^9}, {
   3.6706355326709967`*^9, 3.670635541900044*^9}, {3.670635896925226*^9, 
   3.6706359280261173`*^9}, 3.6706359792497377`*^9, {3.670636074630343*^9, 
   3.670636105588151*^9}, {3.6706368114969883`*^9, 3.670636816287717*^9}, {
   3.670636885359851*^9, 3.6706368871018*^9}, 3.670637520057378*^9, 
   3.670637760979947*^9, {3.670637937939427*^9, 3.670637954082479*^9}, {
   3.67063834847921*^9, 3.670638352732873*^9}, {3.6706384020047398`*^9, 
   3.670638428131322*^9}, {3.67063954288664*^9, 3.670639543548015*^9}, {
   3.670644507489429*^9, 3.6706445079667*^9}, {3.6706446007744083`*^9, 
   3.670644600868038*^9}, {3.6706446529562397`*^9, 3.670644654906649*^9}, {
   3.670644781826004*^9, 3.670644822661952*^9}, {3.6706450628591747`*^9, 
   3.6706450639518642`*^9}, {3.670650348457933*^9, 3.670650367559754*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"randomRow", "[", "]"}], ":=", 
  RowBox[{"row", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomInteger", "[", "zCrit", "]"}], ",", 
     RowBox[{"{", "length", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constantRow", "[", "c_", "]"}], ":=", 
  RowBox[{"row", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"c", ",", 
     RowBox[{"{", "length", "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.67064450981488*^9, 3.670644519222364*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"addGrain", "[", "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "length"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"row", "[", 
        RowBox[{"[", "r", "]"}], "]"}], "++"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"r", ">", "1"}], ",", 
        RowBox[{
         RowBox[{"row", "[", 
          RowBox[{"[", 
           RowBox[{"r", "-", "1"}], "]"}], "]"}], "--"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670636151601828*^9, 3.670636166722478*^9}, {
  3.670636910756195*^9, 3.6706369369258757`*^9}, {3.670637062573241*^9, 
  3.6706371118645782`*^9}, {3.670637205931232*^9, 3.670637303304576*^9}, {
  3.670637377062786*^9, 3.670637422948072*^9}, {3.670637495001423*^9, 
  3.6706374951522093`*^9}, {3.670637591463532*^9, 3.670637631013378*^9}, {
  3.6706376852198*^9, 3.6706377292988663`*^9}, {3.670637771474987*^9, 
  3.670637773105582*^9}, {3.670638398517078*^9, 3.6706383986834717`*^9}, {
  3.670638475561803*^9, 3.670638476840995*^9}, {3.670638556442052*^9, 
  3.670638559479045*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"relaxation1D", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"stable", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", "stable"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stable", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", "length"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"row", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ">", " ", "zCrit"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"stable", "=", "False"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"1", "<", "i", "<", "length"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-=", "2"}], ";", 
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "++"}], ";", 
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "++"}], ";"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-=", "2"}], ";", 
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "++"}], ";"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[Equal]", "length"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "--"}], ";", 
                 RowBox[{
                  RowBox[{"row", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "++"}]}]}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQ/W5W8mWVyNeO5TeYboDopEaPeyD6ywyehyBaSPzw
UxCtNyH2A4jel8OgqAqkty6VBNNCC5aZg+gvFk8swfytM91B9CufN54g+s/d
jBY9IP11/oJWEO1k/Pw3iL4kp/QPRPv8NtbWB9LPfKzA9LnwTbdANNdBttsg
uu15+AcQ/S03FUx37b3HZACk5/3wYQHRFkL+fCDag5NDFERLnJOyANGiu944
guiI2VtCQfRiIe9wEP1BdF08iJ7GFZMCojes/tEJomN0YvtBdMdaNjYjIK0z
2ZsTRFeXTZIH0UXLWRVA9Ply/3sg+vKBKWDaSeThIxBtwsv3GETnsbx9DqIT
9L6A6WMinrtMgfTjo3Vg+pCK034QHS/hB6Zf2JUcAdHb/h08CaIBlzS5iA==

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pourSand", "[", "numGrains_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", 
      RowBox[{"rows", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "1"}], ",", 
       RowBox[{"n", "\[LessEqual]", "numGrains"}], ",", 
       RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"addGrain", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"relaxation1D", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"rows", ",", "row"}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "rows"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.670640034448517*^9, 3.670640074413542*^9}, {
   3.670640111622436*^9, 3.6706401562112627`*^9}, {3.67064019177068*^9, 
   3.670640198418159*^9}, {3.670640349920541*^9, 3.670640376551675*^9}, {
   3.670640769476622*^9, 3.6706407736522083`*^9}, {3.6706427740177193`*^9, 
   3.670642833363367*^9}, {3.670644471224394*^9, 3.67064448263144*^9}, 
   3.6706445397687817`*^9, {3.670645177590901*^9, 3.6706451779094973`*^9}, 
   3.670806604461862*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"constantRow", "[", "0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rows", "=", 
   RowBox[{"pourSand", "[", "1000", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"GraphicsColumn", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListStepPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"rows", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", ";;"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "length"}], "}"}]}], "]"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<i\>\"", ",", "\"\<h\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"length", "*", "zCrit"}], "+", "1"}]}], "}"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ListStepPlot", "[", 
       RowBox[{
        RowBox[{"rows", "[", 
         RowBox[{"[", "t", "]"}], "]"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<i\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "zCrit"}], "-", "1"}], ",", 
           RowBox[{"zCrit", "+", "1"}]}], "}"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", 
     RowBox[{"Length", "[", "rows", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
   RowBox[{"AnimationRate", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.670640165942956*^9, 3.670640189564622*^9}, {
   3.670640255235058*^9, 3.670640262792371*^9}, {3.670640404985317*^9, 
   3.670640406750502*^9}, 3.670640478178788*^9, 3.670640627759945*^9, {
   3.670640708687645*^9, 3.670640708859888*^9}, 3.670641427883388*^9, {
   3.6706417358882847`*^9, 3.6706419727910643`*^9}, {3.670642040779307*^9, 
   3.670642049755105*^9}, {3.6706422289413643`*^9, 3.670642318887772*^9}, {
   3.670642408726111*^9, 3.670642476543838*^9}, {3.670642514588134*^9, 
   3.670642567386112*^9}, {3.6706426241434402`*^9, 3.67064266666263*^9}, {
   3.670642812933423*^9, 3.670642864290378*^9}, {3.670644553127784*^9, 
   3.670644577149531*^9}, {3.670644664973056*^9, 3.670644700033276*^9}, {
   3.6706447338919363`*^9, 3.6706447495605097`*^9}, {3.670644807427887*^9, 
   3.670644876431072*^9}, {3.670644911391144*^9, 3.670644917981215*^9}, {
   3.670644960418167*^9, 3.670645066387751*^9}, {3.670645118038232*^9, 
   3.6706451312497797`*^9}, {3.670645187015779*^9, 3.670645192469298*^9}, {
   3.670645226085885*^9, 3.67064527122759*^9}, {3.670645305187829*^9, 
   3.670645356220088*^9}, {3.670646834693962*^9, 3.670646850345436*^9}, {
   3.670647076099144*^9, 3.67064709747235*^9}, 3.670647305308791*^9, {
   3.670650381118085*^9, 3.670650381262953*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[
   FormBox[
    StyleBox[
     DynamicModuleBox[{$CellContext`t$$ = 155, Typeset`show$$ = True, 
      Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
      Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
      "\"untitled\"", Typeset`specs$$ = {{
        Hold[$CellContext`t$$], 1, 1000, 1}}, Typeset`size$$ = {
      360., {210., 214.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
      Typeset`skipInitDone$$ = True, $CellContext`t$159426$$ = 0}, 
      DynamicBox[Manipulate`ManipulateBoxes[
       1, TraditionalForm, "Variables" :> {$CellContext`t$$ = 1}, 
        "ControllerVariables" :> {
          Hold[$CellContext`t$$, $CellContext`t$159426$$, 0]}, 
        "OtherVariables" :> {
         Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
          Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
          Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
          Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> 
        GraphicsColumn[{
           ListStepPlot[
            Table[
             Total[
              Part[
               Part[$CellContext`rows, $CellContext`t$$], 
               
               Span[$CellContext`i, 
                All]]], {$CellContext`i, $CellContext`length}], 
            FrameLabel -> {"i", "h"}, 
            PlotRange -> {0, $CellContext`length $CellContext`zCrit + 1}], 
           ListStepPlot[
            Part[$CellContext`rows, $CellContext`t$$], 
            FrameLabel -> {"i", "z"}, 
            PlotRange -> {-$CellContext`zCrit - 1, $CellContext`zCrit + 1}]}],
         "Specifications" :> {{$CellContext`t$$, 1, 1000, 1, Appearance -> 
           "Labeled", AnimationRunning -> False, AnimationRate -> Automatic, 
           AppearanceElements -> {
            "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
             "DirectionButton"}}}, 
        "Options" :> {
         ControlType -> Animator, AppearanceElements -> None, 
          DefaultBaseStyle -> "Animate", DefaultLabelStyle -> "AnimateLabel", 
          SynchronousUpdating -> True, ShrinkingDelay -> 10.}, 
        "DefaultOptions" :> {}],
       ImageSizeCache->{405., {246., 253.}},
       SingleEvaluation->True],
      Deinitialization:>None,
      DynamicModuleValues:>{},
      SynchronousInitialization->True,
      UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
      UnsavedVariables:>{Typeset`initDone$$},
      UntrackedVariables:>{Typeset`size$$}], "Animate",
     Deployed->True,
     StripOnInput->False],
    TraditionalForm],
   Manipulate`InterpretManipulate[1]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.67064254524675*^9, 3.670642568215046*^9}, 
   3.6706426674734373`*^9, 3.670642809926433*^9, {3.670642841008926*^9, 
   3.670642864731658*^9}, {3.670642917775036*^9, 3.670642955691597*^9}, {
   3.670644549754939*^9, 3.6706446658263397`*^9}, 3.670644701429081*^9, {
   3.6706447349961367`*^9, 3.670644751399021*^9}, {3.670644786263734*^9, 
   3.6706448770042267`*^9}, {3.670644957185383*^9, 3.67064498961308*^9}, {
   3.670645027801117*^9, 3.670645084725136*^9}, {3.670645122628437*^9, 
   3.670645132252879*^9}, 3.670645198371286*^9, {3.670645249677415*^9, 
   3.67064535793937*^9}, 3.670645461122727*^9, {3.670646823040165*^9, 
   3.6706468521312447`*^9}, {3.670647078136504*^9, 3.670647085658746*^9}, {
   3.670647306684074*^9, 3.6706473197316236`*^9}, {3.670650329632782*^9, 
   3.670650382970113*^9}, 3.670650455293717*^9, 3.670806607392416*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2-D Model", "Section",
 CellChangeTimes->{{3.670636216241534*^9, 3.670636241807906*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Initialization", "Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.6700035946241255`*^9, 3.670003604199503*^9}, 
   3.670208651815277*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.670636827242279*^9, 3.670636838841127*^9}, 
   3.6706368805788593`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridsize", " ", "=", " ", "41"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sandRate", " ", "=", " ", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "How", " ", "many", " ", "steps", " ", "to", " ", "wait", " ", "before", 
    " ", "adding", " ", "more", " ", "sand"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zCrit", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addSand", "[", 
   RowBox[{"place_", ",", " ", "random_"}], "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "x", ",", " ", "y"}], "}"}], ",", " ", 
    RowBox[{"(*", 
     RowBox[{
     "add", " ", "sand", " ", "to", " ", "the", " ", "middle", " ", "of", " ",
       "the", " ", "pile"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"random", "\[Equal]", "True"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", " ", "we", " ", "activate", " ", "random"}], ",", " ", 
         
         RowBox[{"then", " ", "add", " ", "grains", " ", "randomly"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"addGrainRandom", "[", "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "place", "]"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x", "=", 
            RowBox[{"place", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"y", "=", 
            RowBox[{"place", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"grid", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", "y"}], "]"}], "]"}], " ", "+=", " ", "1"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6700035674723597`*^9, 3.6700036542782106`*^9}, {
   3.670003729539316*^9, 3.6700037396323767`*^9}, {3.670207058776082*^9, 
   3.6702070654095435`*^9}, {3.6702073107343826`*^9, 3.670207316806773*^9}, {
   3.670208390367284*^9, 3.670208394278058*^9}, {3.6702089985026712`*^9, 
   3.670209004866353*^9}, {3.6702859740925617`*^9, 3.6702859886186266`*^9}, 
   3.670287023278055*^9, 3.6702871403086767`*^9, {3.6702877382812357`*^9, 
   3.670287740899297*^9}, {3.670288056467272*^9, 3.67028807183197*^9}, {
   3.670289408833767*^9, 3.670289413297996*^9}, {3.670530994361991*^9, 
   3.6705310018046536`*^9}, {3.670531058545551*^9, 3.6705310678622437`*^9}, {
   3.6705311498230276`*^9, 3.670531150029791*^9}, {3.670531234651291*^9, 
   3.67053123818919*^9}, {3.6706478198241377`*^9, 3.6706478393187304`*^9}, {
   3.670649879546425*^9, 3.670649913282119*^9}, {3.6706502362129*^9, 
   3.6706502376998663`*^9}, {3.670651331502338*^9, 3.6706513316056433`*^9}, 
   3.670652058550596*^9, {3.6706892494756384`*^9, 3.6706892664886208`*^9}, {
   3.6706893117052517`*^9, 3.670689339172864*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"addGrainRandom", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "gridsize"}], "}"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}], "++"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670651937473474*^9, 3.670652056859351*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.670651935330867*^9, 3.670651936275573*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.670805080161933*^9, 3.670805111875999*^9}, {
  3.670805276250597*^9, 3.6708055247408133`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reset Button", "Subsubsection",
 CellChangeTimes->{{3.670287147812068*^9, 3.670287153700289*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"reset", "[", "]"}], ":=", 
   RowBox[{"grid", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "gridsize"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "gridsize"}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.670650665554462*^9, 3.6706506660102797`*^9}, {
  3.6706513855571537`*^9, 3.6706513857634*^9}, {3.670805711605267*^9, 
  3.670805711787799*^9}, {3.6708058878097277`*^9, 3.6708058880708637`*^9}, {
  3.6708060061874437`*^9, 3.6708060108111153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reset", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.670806000838937*^9, 3.670806018244046*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"heights", "[", "grid_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", 
      RowBox[{"heights", "=", "grid"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"gridsize", "-", "1"}]}], ",", 
       RowBox[{"i", ">", "0"}], ",", 
       RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"gridsize", "-", "1"}]}], ",", 
          RowBox[{"j", ">", "0"}], ",", 
          RowBox[{"j", "--"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"heights", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"0.5", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
               RowBox[{"heights", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}], "+", 
               RowBox[{"heights", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ")"}]}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "heights"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.670805607816135*^9, 3.6708057005563707`*^9}, {
  3.6708057595955963`*^9, 3.6708057611301517`*^9}, {3.67080579488354*^9, 
  3.670805814315743*^9}, {3.670806930068492*^9, 3.670806931786867*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Active Code", "Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.670208620829195*^9, 3.67020862601001*^9}}],

Cell["\<\
Relaxation is repeated until the configuration is stable. s is the total \
number of topplings and T is the number of relaxation steps.\
\>", "Text",
 CellChangeTimes->{{3.670650514628924*^9, 3.670650549370344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"relaxation", "[", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", " ", ",", "j", ",", 
       RowBox[{"s", "=", "0"}], ",", 
       RowBox[{"T", "=", "0"}], ",", 
       RowBox[{"stable", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"While", " ", "[", 
       RowBox[{
        RowBox[{"!", "stable"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stable", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", " ", "gridsize"}], ",", " ", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", " ", 
              RowBox[{"j", "\[LessEqual]", " ", "gridsize"}], ",", " ", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"grid", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", ">", " ", 
                  "zCrit"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"stable", "=", "False"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"s", "++"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"grid", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "-=", " ", 
                   "4"}], ";", " ", 
                  RowBox[{"(*", 
                   RowBox[{"Lose", " ", "4", " ", "sand"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "give", " ", "sand", " ", "to", " ", "the", " ", 
                    "neighbors"}], " ", "|", " ", 
                    RowBox[{"Open", " ", "Boundry", " ", "Conditions"}]}], 
                   " ", "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"i", "\[NotEqual]", " ", "gridsize"}], ",", " ", 
                    RowBox[{
                    RowBox[{"grid", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", " ", "j"}], "]"}], "]"}], 
                    "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", "\[NotEqual]", " ", "gridsize"}], ",", " ", 
                    RowBox[{
                    RowBox[{"grid", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "++"}]}], "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"i", "\[NotEqual]", " ", "1"}], ",", " ", 
                    RowBox[{
                    RowBox[{"grid", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", " ", "j"}], "]"}], "]"}], 
                    "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", "\[NotEqual]", " ", "1"}], ",", " ", 
                    RowBox[{
                    RowBox[{"grid", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", 
                    RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "++"}]}], "]"}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", " ", 
         RowBox[{"(*", 
          RowBox[{"end", " ", "of", " ", "double", " ", "for", " ", "loop"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "stable"}], ",", 
           RowBox[{"T", "++"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"s", ",", "T"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6700037568453274`*^9, 3.6700038025405893`*^9}, {
   3.670207087052264*^9, 3.670207185241086*^9}, {3.670207285583616*^9, 
   3.6702072912786894`*^9}, {3.6702073892354393`*^9, 
   3.6702074285724063`*^9}, {3.6702075587363853`*^9, 
   3.6702075592132487`*^9}, {3.670208109704667*^9, 3.6702083539628615`*^9}, {
   3.6702084046518307`*^9, 3.670208438302224*^9}, 3.670208555116831*^9, {
   3.6702087055054283`*^9, 3.670208724159105*^9}, {3.6702090700269356`*^9, 
   3.670209151622178*^9}, {3.6702091988849597`*^9, 3.670209332481083*^9}, {
   3.6702093797615967`*^9, 3.670209392612152*^9}, {3.670214225425387*^9, 
   3.6702142269904795`*^9}, 3.6702859504602094`*^9, {3.670286304576234*^9, 
   3.6702863051924686`*^9}, {3.6702880741333466`*^9, 
   3.6702880757669983`*^9}, {3.670646885055481*^9, 3.670646934322888*^9}, {
   3.6706478430338*^9, 3.670647843862027*^9}, {3.67064948304058*^9, 
   3.670649516470705*^9}, {3.6706496651397343`*^9, 3.6706497627113323`*^9}, {
   3.6706500850262403`*^9, 3.670650106472371*^9}, {3.670650178057517*^9, 
   3.670650181582308*^9}, {3.67065055694275*^9, 3.670650558211388*^9}, 
   3.670650653881053*^9, {3.670651600150214*^9, 3.670651637117935*^9}, {
   3.670651680185507*^9, 3.6706517078229227`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pourSand", "[", 
    RowBox[{"totalSand_", ",", " ", 
     RowBox[{"random_:", "False"}], ",", 
     RowBox[{"place_:", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"IntegerPart", "[", 
          RowBox[{"gridsize", "/", "2"}], "]"}], ",", " ", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{"gridsize", "/", "2"}], "]"}]}], "}"}], "}"}]}]}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "s", ",", "T", ",", 
       RowBox[{"sList", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TList", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"grids", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", "=", "1"}], ",", 
        RowBox[{"n", "\[LessEqual]", " ", "totalSand"}], ",", 
        RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"addSand", "[", 
          RowBox[{"place", ",", " ", "random"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s", ",", "T"}], "}"}], "=", 
          RowBox[{"relaxation", "[", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"grids", ",", "grid"}], "]"}], 
          RowBox[{"AppendTo", "[", 
           RowBox[{"sList", ",", "s"}], "]"}]}], ";", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"TList", ",", "T"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"grids", ",", "sList", ",", "TList"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6702861272240305`*^9, 3.670286131658803*^9}, {
   3.6702862922282906`*^9, 3.6702862924211874`*^9}, {3.6702867480730295`*^9, 
   3.6702867481354823`*^9}, {3.670286903490368*^9, 3.6702869075234847`*^9}, {
   3.670531075680955*^9, 3.6705311094399543`*^9}, 3.670531164000408*^9, {
   3.670651207566972*^9, 3.6706513038541613`*^9}, {3.670651403740975*^9, 
   3.6706514242111197`*^9}, {3.6706515435210543`*^9, 3.670651546063765*^9}, {
   3.670651655268001*^9, 3.670651663248413*^9}, {3.670651779708129*^9, 
   3.670651803193137*^9}, {3.670689347055499*^9, 3.67068936677769*^9}, {
   3.670805972456517*^9, 3.670805978357823*^9}, {3.670806651636063*^9, 
   3.6708066674101458`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gather Statistics", "Subsubsection",
 CellChangeTimes->{{3.670690096808093*^9, 3.6706901005126104`*^9}}],

Cell["Distribution of slopes", "Text",
 CellChangeTimes->{{3.670690103559189*^9, 3.6706901107914147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"slopeDist", "[", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"slopes", ",", " ", 
      RowBox[{"slopedist", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "i", ",", " ", "j"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"slopes", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "0", ",", " ", "zCrit"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", "gridsize"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", " ", 
          RowBox[{"j", "\[LessEqual]", "gridsize"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"slopes", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "+", " ", "1"}], 
              "]"}], "]"}], "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"make", " ", "x"}], "-", 
       RowBox[{"coordinate", " ", "and", " ", "y"}], "-", 
       RowBox[{"coordinate", " ", "pair"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "slopes", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"slopedist", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", " ", 
            RowBox[{"slopes", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "slopedist"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.670690120565658*^9, 3.6706901330739737`*^9}, {
  3.670690168715764*^9, 3.670690281016213*^9}, {3.670690415614914*^9, 
  3.6706905065571475`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run and Plot the Simulation", "Subsubsection",
 CellChangeTimes->{{3.67028830224984*^9, 3.6702883061856146`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reset", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6708059902360983`*^9, 3.670805991940957*^9}, {
  3.670806029348736*^9, 3.6708060329078836`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"grids", ",", "sList", ",", "TList"}], "}"}], "=", 
   RowBox[{"pourSand", "[", 
    RowBox[{"1000", ",", " ", "True"}], "]"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "3", " ", "parameter", " ", "to", " ", "true", " ", "if", " ", 
    "you", " ", "want", " ", "grains", " ", "to", " ", "be", " ", "added", 
    " ", "in", " ", "random", " ", "positions"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.6702859322849283`*^9, 3.6702859614343853`*^9}, {
   3.6702860221837025`*^9, 3.6702860236159105`*^9}, 3.670286138131914*^9, 
   3.670286809097667*^9, {3.6702868412977843`*^9, 3.6702868423997726`*^9}, 
   3.6702871056671853`*^9, 3.670287202177389*^9, 3.670289436784025*^9, {
   3.6702895420402536`*^9, 3.670289555098251*^9}, {3.670531172805149*^9, 
   3.6705311913801556`*^9}, {3.670649795303378*^9, 3.6706498968813353`*^9}, {
   3.670649947914124*^9, 3.670649948993037*^9}, {3.670650191702284*^9, 
   3.670650241395158*^9}, {3.670650583668469*^9, 3.670650605625211*^9}, {
   3.67065130978328*^9, 3.6706513224053383`*^9}, {3.67065151726453*^9, 
   3.67065152544779*^9}, {3.670651812705233*^9, 3.670651860417141*^9}, {
   3.670689076704313*^9, 3.6706890769516*^9}, {3.6706893755659475`*^9, 
   3.670689410709156*^9}, {3.6706895740500154`*^9, 3.670689603231742*^9}, {
   3.6706896511583023`*^9, 3.6706896741461716`*^9}, {3.6706897378525543`*^9, 
   3.670689751731151*^9}, {3.6706905843885856`*^9, 3.6706905853791256`*^9}, 
   3.670805894016836*^9, {3.670805958166151*^9, 3.670805985926292*^9}, {
   3.6708060950193243`*^9, 3.67080609533698*^9}, 3.670806250902162*^9, {
   3.67080667164476*^9, 3.670806672082673*^9}, {3.6708067861522007`*^9, 
   3.670806786454555*^9}, {3.670806947555683*^9, 3.670806950914152*^9}, 
   3.670806992136415*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"grids", "[", 
     RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", 
     RowBox[{"Length", "[", "grids", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.670806738758477*^9, 3.6708067961740417`*^9}, {
  3.670806898887251*^9, 3.670806904987431*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[
   FormBox[
    StyleBox[
     DynamicModuleBox[{$CellContext`t$$ = 166, Typeset`show$$ = True, 
      Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
      Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
      "\"untitled\"", Typeset`specs$$ = {{
        Hold[$CellContext`t$$], 1, 1000, 1}}, Typeset`size$$ = {
      360., {177., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
      Typeset`skipInitDone$$ = True, $CellContext`t$246215$$ = 0}, 
      DynamicBox[Manipulate`ManipulateBoxes[
       1, TraditionalForm, "Variables" :> {$CellContext`t$$ = 1}, 
        "ControllerVariables" :> {
          Hold[$CellContext`t$$, $CellContext`t$246215$$, 0]}, 
        "OtherVariables" :> {
         Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
          Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
          Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
          Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> ArrayPlot[
          Part[$CellContext`grids, $CellContext`t$$]], 
        "Specifications" :> {{$CellContext`t$$, 1, 1000, 1, Appearance -> 
           "Labeled", 
           AppearanceElements -> {
            "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
             "DirectionButton"}}}, 
        "Options" :> {
         ControlType -> Animator, AppearanceElements -> None, 
          DefaultBaseStyle -> "Animate", DefaultLabelStyle -> "AnimateLabel", 
          SynchronousUpdating -> True, ShrinkingDelay -> 10.}, 
        "DefaultOptions" :> {}],
       ImageSizeCache->{405., {214., 221.}},
       SingleEvaluation->True],
      Deinitialization:>None,
      DynamicModuleValues:>{},
      SynchronousInitialization->True,
      UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
      UnsavedVariables:>{Typeset`initDone$$},
      UntrackedVariables:>{Typeset`size$$}], "Animate",
     Deployed->True,
     StripOnInput->False],
    TraditionalForm],
   Manipulate`InterpretManipulate[1]], TraditionalForm]], "Output",
 CellChangeTimes->{3.670807039287662*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"heights", "[", 
     RowBox[{"grids", "[", 
      RowBox[{"[", "t", "]"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "1", ",", 
     RowBox[{"Length", "[", "grids", "]"}], ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Dynamic", "[", 
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"grid", ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6702869552154093`*^9, 3.6702869604373145`*^9}, {
   3.6702870040789757`*^9, 3.6702870116285143`*^9}, {3.67028717519384*^9, 
   3.6702871763940783`*^9}, {3.6702872638648043`*^9, 3.6702872671292067`*^9}, 
   3.670287311325121*^9, {3.6702885120817785`*^9, 3.6702885317573233`*^9}, {
   3.6702893925070853`*^9, 3.670289394048932*^9}, {3.6702895082756205`*^9, 
   3.6702895115984626`*^9}, {3.670646565346911*^9, 3.670646565585709*^9}, {
   3.670646616555067*^9, 3.670646634312932*^9}, {3.6708059540151587`*^9, 
   3.670805954872246*^9}, {3.670806237583953*^9, 3.670806239852871*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Dynamic", "[", 
   RowBox[{"ListPlot3D", "[", 
    RowBox[{
     RowBox[{"heights", "[", "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<SouthwestColors\>\""}]}], "]"}],
    "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.670806733631798*^9, 3.670806735967567*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"slopeDist", "[", "]"}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Slope Distribution\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6706902879925747`*^9, 3.6706903343661814`*^9}, {
  3.670690513945593*^9, 3.670690550928132*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{0., 1332.}, {1., 44.}, {2., 76.}, {3., 112.}, {4., 
      117.}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"Slope Distribution\"", TraditionalForm],
  PlotRange->{{0, 4.}, {0, 226.5}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.670690302969252*^9, 3.6706903352986174`*^9, {3.6706905115914297`*^9, 
   3.6706905514067965`*^9}, 3.6706906573524094`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{720, 874},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 70, 1, 46, "Input"],
Cell[CellGroupData[{
Cell[653, 25, 203, 3, 92, "Title"],
Cell[859, 30, 243, 4, 35, "Text"],
Cell[CellGroupData[{
Cell[1127, 38, 146, 2, 64, "Section"],
Cell[1276, 42, 99, 1, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1412, 48, 197, 3, 64, "Section"],
Cell[1612, 53, 1305, 32, 131, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2954, 90, 94, 1, 64, "Section"],
Cell[3051, 93, 1319, 20, 46, "Input"],
Cell[4373, 115, 513, 14, 46, "Input"],
Cell[4889, 131, 1371, 32, 97, "Input"],
Cell[6263, 165, 3270, 79, 267, "Input"],
Cell[9536, 246, 1298, 28, 148, "Input"],
Cell[CellGroupData[{
Cell[10859, 278, 3240, 69, 114, "Input"],
Cell[14102, 349, 3539, 69, 516, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17690, 424, 94, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[17809, 429, 167, 2, 36, "Subsubsection"],
Cell[17979, 433, 167, 3, 28, "Input"],
Cell[18149, 438, 3392, 75, 250, "Input"],
Cell[21544, 515, 739, 22, 80, "Input"],
Cell[22286, 539, 92, 1, 28, "Input"],
Cell[22381, 542, 143, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22561, 549, 103, 1, 35, "Subsubsection"],
Cell[22667, 552, 677, 17, 28, "Input"],
Cell[23347, 571, 137, 3, 28, "Input"],
Cell[23487, 576, 1826, 46, 148, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25350, 627, 135, 1, 36, "Subsubsection"],
Cell[25488, 630, 225, 4, 30, "Text"],
Cell[25716, 636, 5794, 122, 387, "Input"],
Cell[31513, 760, 2528, 59, 165, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34078, 824, 110, 1, 35, "Subsubsection"],
Cell[34191, 827, 106, 1, 30, "Text"],
Cell[34300, 830, 2460, 62, 233, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36797, 897, 119, 1, 35, "Subsubsection"],
Cell[36919, 900, 190, 4, 28, "Input"],
Cell[37112, 906, 1817, 30, 63, "Input"],
Cell[CellGroupData[{
Cell[38954, 940, 474, 12, 46, "Input"],
Cell[39431, 954, 2120, 44, 452, "Output"]
}, Open  ]],
Cell[41566, 1001, 395, 11, 46, "Input"],
Cell[41964, 1014, 804, 14, 28, "Input"],
Cell[42771, 1030, 375, 9, 46, "Input"],
Cell[CellGroupData[{
Cell[43171, 1043, 306, 7, 28, "Input"],
Cell[43480, 1052, 1566, 38, 258, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

